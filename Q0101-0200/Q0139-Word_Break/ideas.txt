Use hash set and dp.

Time Complexity: O(N^3).
Space Complexity: O(N).
